# vi:ft=sh

# PROMPT
case ${TERM} in
  xterm*|rxvt*|Eterm|aterm|kterm|gnome*)
  PROMPT_COMMAND='echo -ne "\033]0;${PWD/$HOME/~}\007"'
  ;;
  screen)
  PROMPT_COMMAND='echo -ne "\033_${PWD/$HOME/~}\033\\"'
  ;;
esac

# set a fancy prompt (non-color, unless we know we "want" color)

function parse_git_branch() {
  GIT_BRANCH=`__git_ps1`
  if [ "$GIT_BRANCH" ] ; then
    GIT_STATUS=`git status 2> /dev/null`
    CLR='2'
    if [ "`echo $GIT_STATUS | grep 'Changed but not updated'`" ] ; then
      CLR='1'
    fi

    pt=`echo $GIT_STATUS | grep 'Your branch is ahead' | awk {'print $13'}`
    if [ "${pt}" ] ; then
      PTIMES="${pt} â†‘ "
    else
      PTIMES=" "
    fi

    RSLT="[01;3${CLR};40m[${GIT_BRANCH} ${PTIMES}][0m"
  fi
  echo $RSLT
}

COL=`expr $COLUMNS - 1`
LINE=''
COUNT=0
while test ${COL} -gt $COUNT
do
  let COUNT++
  LINE="${LINE}â”€"
done

export PS1='â”Œ${LINE}[${COL}Dâ”€â”€â”€â”€[01;30m[\u@\h][0mâ”€â”€â”€â”€â”€[01;36m[\t][0mâ”€â”€â”€â”€â”€[01;34m[\W][0mâ”€â”€â”€â”€â”€$(parse_git_branch)â”€â”€â”€
â””â”€> [01;32m\$[0m '
